{% extends "layout.html" %}

{% block content %}

<div class="container">
    <div class="row">
        <div class="col s12">
            <br><br>
            <h2>Materia Prima</h2>
            <ul id="tabs-swipe-demo teal lighten-1" class="tabs">
                <li class="tab col s4  "><a class="active" href="#test-swipe-1">Activos</a></li>
                <li class="tab col s4"><a href="#test-swipe-2">Inactivos</a></li>
                <li class="tab col s4"><a href="#test-swipe-3">Registro</a></li>
            </ul>
            <div id="test-swipe-1">
                <div class="section">
                    <table class="responsive-table highlight centered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Descripción</th>
                                <th>Categoria</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>Fecha</th>
                                <th>Proveedor</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {%for x in matPr%}
                            {%if x.cantidad <= 10 %} <tr class="red darken-4">
                                <td>
                                    {{x.idMateriaPrima}}
                                </td>
                                <td >
                                    {{x.nombre}}
                                </td>
                                <td>
                                    {{x.descripcion}}
                                </td>
                                <td>
                                    {{x.categoria}}
                                </td>
                                <td>
                                    ${{x.precio}}
                                </td>
                                <td>
                                    {{x.cantidad}} Kg
                                </td>
                                <td>
                                    {{x.fecha}}
                                </td>
                                <td>
                                    {{x.proveedor.empresa}}
                                </td>
                                <td>
                                    <a onclick="confirmarEliminacion('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                        class="waves-effect waves-light red btn modal-trigger"> <i
                                            class="material-icons">delete</i></a>
                                    <a onclick="modal('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                        class="waves-effect waves-light blue btn modal-trigger" href="#modal1"> <i
                                            class="material-icons">edit</i></a>
                                    <a onclick="modal('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                        class="waves-effect waves-light green btn modal-trigger" href="#modal1"> <i
                                            class="material-icons">add_shopping_cart
                                        </i></a>
                                </td>
                                </tr>
                                {%else%}
                                <tr>
                                    <td>
                                        {{x.idMateriaPrima}}
                                    </td>
                                    <td>
                                        {{x.nombre}}
                                    </td>
                                    <td>
                                        {{x.descripcion}}
                                    </td>
                                    <td>
                                        {{x.categoria}}
                                    </td>
                                    <td>
                                        ${{x.precio}}
                                    </td>
                                    <td>
                                        {{x.cantidad}} Kg
                                    </td>
                                    <td>
                                        {{x.fecha}}
                                    </td>
                                    <td>
                                        {{x.proveedor.empresa}}
                                    </td>
                                    <td>
                                        <a onclick="confirmarEliminacion('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                            class="waves-effect waves-light red btn modal-trigger"> <i
                                                class="material-icons">delete</i></a>
                                        <a onclick="modal('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                            class="waves-effect waves-light blue btn modal-trigger" href="#modal1"> <i
                                                class="material-icons">edit</i></a>
                                    </td>
                                </tr>

                                {%endif%}
                                {%endfor%}
                        </tbody>
                    </table>
                </div>
            </div>
            <div id="test-swipe-2">
                <table class="responsive-table highlight centered">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Descripción</th>
                            <th>Categoria</th>
                            <th>Precio</th>
                            <th>Cantidad</th>
                            <th>Fecha</th>
                            <th>Proveedor</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {%for x in matPrIn%}
                        <tr>
                            <td>
                                {{x.idInventario}}
                            </td>
                            <td>
                                {{x.nombre}}
                            </td>
                            <td>
                                {{x.descripcion}}
                            </td>
                            <td>
                                {{x.categoria}}
                            </td>
                            <td>
                                ${{x.precio}}
                            </td>
                            <td>
                                {{x.cantidad}} Kg
                            </td>
                            <td>
                                {{x.fecha}}
                            </td>
                            <td>
                                {{x.proveedor.empresa}}
                            </td>
                            <td>
                                <a onclick="confirmarActivacion('{{x.idMateriaPrima}}','{{x.nombre}}','{{x.descripcion}}','{{x.categoria}}','{{x.precio}}', '{{x.cantidad}}','{{x.proveedor.idProveedor}}')"
                                    class="waves-effect waves-light green btn modal-trigger"> <i
                                        class="material-icons">check</i></a>
                            </td>
                        </tr>
                        {%endfor%}
                    </tbody>
                </table>
            </div>
            <div id="test-swipe-3">
                <div class="row">
                    <div class="col s12 center">
                        <h3><i class="mdi-content-send brown-text"></i></h3>
                        <div class="row">
                            <div class="col s12 m6 imagenes">
                                <div class="card" style="background:black;">
                                    <div class="card-image imagenes">
                                        <img src="../../static/img/background1.jpg">
                                        <span class="card-title">Nueva materia prima</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12 m6 ">
                                <div class="card">
                                    <div class="card-content">
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <i class="material-icons prefix">assignment</i>
                                                <input class="validate" name="text" id="text" type="text">
                                                <label for="text" data-error="wrong" data-success="right">Nombre</label>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="input-field col s6">
                                                <i class="material-icons prefix">description</i>
                                                <input class="validate" name="desc" id="desc" type="text">
                                                <label for="desc" data-error="wrong"
                                                    data-success="right">Descripción</label>
                                            </div>

                                            <div class="input-field col s6">
                                                <i class="material-icons prefix">class</i>
                                                <input class="validate" name="text" id="ffd" type="text">
                                                <label for="text" data-error="wrong"
                                                    data-success="right">Categoria</label>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="input-field col s6">
                                                <i class="material-icons prefix">attach_money</i>
                                                <input class="validate" name="text" id="text" type="number">
                                                <label for="text" data-error="wrong" data-success="right">Precio</label>
                                            </div>
                                            <div class="input-field col s6">
                                                <i class="material-icons prefix">shopping_basket</i>
                                                <input class="validate" name="text" id="text" type="number">
                                                <label for="text" data-error="wrong"
                                                    data-success="right">Cantidad</label>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <i class="material-icons prefix">date_range</i>
                                                <input class="validate" type="text" class="datepicker">
                                                <label for="text" data-error="wrong" data-success="right">Fecha</label>
                                            </div>
                                        </div>
                                        <div class="row">

                                            <div class="input-field col s12">

                                                <select class="validate">
                                                    <option value="" disabled selected>Elegir...</option>
                                                    {%for xs in prov%}
                                                    <option class="red" value="{{xs.idProveedor}}">{{xs.empresa}}
                                                    </option>
                                                    {%endfor%}
                                                </select>
                                                <label>Proveedor</label>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <button class="btn waves-effect waves-red orange accent-4 btn-large"
                                                    type="submit" name="action">Enviar
                                                    <i class="material-icons right">send</i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Structure -->
<div id="modal1" class="modal modal-fixed-footer">
    <div class="modal-content">
        <h4>Actualizar Materia Prima</h4>
        <div class="row">
            <div class="input-field col s12">
                <i class="material-icons prefix">assignment</i>
                <input class="validate" name="text" id="text" type="text">
                <label for="text" data-error="wrong" data-success="right">Nombre</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s6">
                <i class="material-icons prefix">description</i>
                <input class="validate" name="desc" id="desc" type="text">
                <label for="desc" data-error="wrong" data-success="right">Descripción</label>
            </div>

            <div class="input-field col s6">
                <i class="material-icons prefix">class</i>
                <input class="validate" name="text" id="ffd" type="text">
                <label for="text" data-error="wrong" data-success="right">Categoria</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s6">
                <i class="material-icons prefix">attach_money</i>
                <input class="validate" name="text" id="text" type="number">
                <label for="text" data-error="wrong" data-success="right">Precio</label>
            </div>
            <div class="input-field col s6">
                <i class="material-icons prefix">shopping_basket</i>
                <input class="validate" name="text" id="text" type="number">
                <label for="text" data-error="wrong" data-success="right">Cantidad</label>
            </div>
        </div>
        <div class="row">
            <div class="input-field col s12">
                <i class="material-icons prefix">date_range</i>
                <input class="validate" type="text" class="datepicker">
                <label for="text" data-error="wrong" data-success="right">Fecha</label>
            </div>
        </div>
        <div class="row">

            <div class="input-field col s12">

                <select class="validate">
                    <option value="" disabled selected>Elegir...</option>
                    {%for xs in prov%}
                    <option class="red" value="{{xs.idProveedor}}">{{xs.empresa}}</option>
                    {%endfor%}
                </select>
                <label>Proveedor</label>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <a class="waves-effect waves-light red btn modal-close" id="closebtn" type="submit" name="action">
            <i class="material-icons">cancel</i>
        </a>
        <a class="waves-effect waves-light green btn modal-trigger" id="updateBtn" type="submit" name="action">
            <i class="material-icons">send</i>
        </a>
    </div>
</div>


<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
        var elems = document.querySelectorAll('.modal');
        var options = {}
        var instances = M.Modal.init(elems, options);
    });

    $(document).ready(function () {
        $('ul.tabs').tabs();
    });

    function modal(idMateriaPrima, nombre, descripcion, categoria, precio, cantidad, proveedor_empresa) {


        $("#updateBtn").click(function () {
            swal({
                title: "¿Quieres actualizar el producto?",
                text: "No se podrá deshacer esta acción",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            }).then((willDelete) => {
                if (willDelete) {
                    window.location.href = 'modificarProducto?id=' + idMateriaPrima + '&name=' + nombre
                        + '&descripcion=' + descripcion + '&categoria=' + categoria + '&precio=' + precio + '&cantidad='
                        + cantidad + '&fecha=' + fecha + '&proveedor_empresa=' + proveedor_empresa;
                } else {
                }
            });
            $(".modal").removeClass("is-active");
        });
    }

    var confirmarEliminacion = (idMateriaPrima, nombre, descripcion, categoria, precio, cantidad, proveedor_empresa) => {
        swal({
            title: "¿Quieres borrar " + nombre + " de la materia prima? ",
            text: "No se podrá deshacer esta acción",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        }).then((willDelete) => {
            if (willDelete) {
                swal("Eliminada con éxito", {
                    icon: "success",
                });
                window.location.href = 'deleteMatPrim?id=' + idMateriaPrima + '&name=' + nombre
                    + '&descripcion=' + descripcion + '&categoria=' + categoria + '&precio=' + precio + '&cantidad='
                    + cantidad + '&proveedor_empresa=' + proveedor_empresa;
            } else {
            }
        });
    };
    var confirmarActivacion = (idMateriaPrima, nombre, descripcion, categoria, precio, cantidad, proveedor_empresa) => {
        swal({
            title: "¿Quieres activar la materia prima " + nombre + "?",
            text: "No se podrá deshacer esta acción",
            icon: "info",
            buttons: true,
            dangerMode: true,
        }).then((willDelete) => {
            if (willDelete) {
                swal("Activado con éxito", {
                    icon: "success",
                });
                window.location.href = 'updateMatPrim?id=' + idMateriaPrima + '&name=' + nombre
                    + '&descripcion=' + descripcion + '&categoria=' + categoria + '&precio=' + precio + '&cantidad='
                    + cantidad + '&proveedor_empresa=' + proveedor_empresa;
            } else {
            }
        });
    };
</script>
{%endblock%}